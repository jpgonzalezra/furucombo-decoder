import { BigNumber } from 'ethers';
import { decoder } from './decoder';

describe('furucombo uniswap decoder', () => {
  // https://etherscan.io/tx/0xb8386ca5ab3723683c6089c826ddf09cd23e787ff44e6df5c5401281b13ec307
  it('decode batchExec operation', async () => {
    const data =
      '0x74a28f79000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000914490a362f4507058403a99e28bdf685c5c767f00000000000000000000000058a21cfcee675d65d577b251668f7dc46ea9c3a000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000c4d0797f840000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000010000000000000000000000007e9f9f3b323582584526d9f83276338c89f8fbe70000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000187d4a6786a2b7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c4ef66f725000000000000000000000000000000000000000000000187d4a6786a2b70000000000000000000000000000000000000000000000000000000f2bedcd2a3a000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000020000000000000000000000007e9f9f3b323582584526d9f83276338c89f8fbe7000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000';
    const result = decoder(data);
    expect(result).toMatchObject([
      {
        tokens: ['0x7E9f9F3b323582584526d9f83276338C89f8fBE7'],
        amounts: [BigNumber.from('7228000000000000000000')],
      },
      {
        amountIn: BigNumber.from('7228000000000000000000'),
        amountOutMin: BigNumber.from('68326800000000000'),
        path: [
          '0x7E9f9F3b323582584526d9f83276338C89f8fBE7',
          '0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2',
        ],
      },
    ]);
  });
});
